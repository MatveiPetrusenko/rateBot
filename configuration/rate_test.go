package configuration_test

import (
	"encoding/json"
	"github.com/matthew/rateBot/configuration"
	"github.com/stretchr/testify/assert"
	"testing"
)

func TestParsingJSON(t *testing.T) {
	s := `{
		"motd": {
			"msg": "If you or your company use this project or like what we doing, please consider backing us so we can continue maintaining and evolving this project.",
				"url": "https://exchangerate.host/#/donate"
		},
		"success": true,
			"base": "USD",
			"date": "2022-11-24",
			"rates": {
                "AED": 3.670989,
				"AFN": 88.571762,
				"ALL": 112.059087,
				"AMD": 395.332402,
				"ANG": 1.801076,
				"AOA": 510.628939,
				"ARS": 164.66393,
				"AUD": 1.479901,
				"AWG": 1.801124,
				"AZN": 1.699108,
				"BAM": 1.876183,
				"BBD": 1.999567,
				"BDT": 101.964733,
				"BGN": 1.87444,
				"BHD": 0.376627,
				"BIF": 2063.367722,
				"BMD": 1.000342,
				"BND": 1.370615,
				"BOB": 6.907614,
				"BRL": 5.356669,
				"BSD": 1.000461,
				"BTC": 0.00006,
				"BTN": 81.803148,
				"BWP": 12.930568,
				"BYN": 2.524718,
				"BZD": 2.014983,
				"CAD": 1.334449,
				"CDF": 2051.439766,
				"CHF": 0.939736,
				"CLF": 0.033789,
				"CLP": 915.900678,
				"CNH": 7.140153,
				"CNY": 7.132891,
				"COP": 4848.518617,
				"CRC": 606.627228,
				"CUC": 0.999881,
				"CUP": 25.73487,
				"CVE": 106.786098,
				"CZK": 23.325897,
				"DJF": 176.157708,
				"DKK": 7.120228,
				"DOP": 54.420678,
				"DZD": 138.617052,
				"EGP": 24.527545,
				"ERN": 14.991652,
				"ETB": 52.865479,
				"EUR": 0.958145,
				"FJD": 2.210622,
				"FKP": 0.826488,
				"GBP": 0.826856,
				"GEL": 2.723371,
				"GGP": 0.826684,
				"GHS": 14.34857,
				"GIP": 0.827192,
				"GMD": 61.514357,
				"GNF": 8675.762339,
				"GTQ": 7.78737,
				"GYD": 209.121866,
				"HKD": 7.805939,
				"HNL": 24.78818,
				"HRK": 7.219457,
				"HTG": 137.418138,
				"HUF": 392.557192,
				"IDR": 15620.846094,
				"ILS": 3.421651,
				"IMP": 0.82687,
				"INR": 81.630246,
				"IQD": 1444.211796,
				"IRR": 42424.546059,
				"ISK": 140.446777,
				"JEP": 0.826532,
				"JMD": 154.19533,
				"JOD": 0.709111,
				"JPY": 138.745978,
				"KES": 122.127342,
				"KGS": 84.023579,
				"KHR": 4092.70103,
				"KMF": 475.765052,
				"KPW": 899.46115,
				"KRW": 1327.401857,
				"KWD": 0.30782,
				"KYD": 0.833733,
				"KZT": 459.997845,
				"LAK": 17116.090235,
				"LBP": 1510.573918,
				"LKR": 365.336054,
				"LRD": 153.908573,
				"LSL": 17.141873,
				"LYD": 4.916825,
				"MAD": 10.622888,
				"MDL": 19.18661,
				"MGA": 4334.2242,
				"MKD": 59.678542,
				"MMK": 2099.063354,
				"MNT": 3404.923177,
				"MOP": 8.047647,
				"MRU": 37.632997,
				"MUR": 43.62376,
				"MVR": 15.371803,
				"MWK": 1025.329207,
				"MXN": 19.346286,
				"MYR": 4.506684,
				"MZN": 63.812342,
				"NAD": 17.249895,
				"NGN": 443.034173,
				"NIO": 35.979996,
				"NOK": 9.902249,
				"NPR": 130.885595,
				"NZD": 1.598103,
				"OMR": 0.385492,
				"PAB": 1.000335,
				"PEN": 3.806582,
				"PGK": 3.521321,
				"PHP": 56.701528,
				"PKR": 223.925857,
				"PLN": 4.503751,
				"PYG": 7190.898947,
				"QAR": 3.640125,
				"RON": 4.72209,
				"RSD": 112.359849,
				"RUB": 60.528453,
				"RWF": 1069.613976,
				"SAR": 3.756408,
				"SBD": 8.226026,
				"SCR": 13.613762,
				"SDG": 569.159027,
				"SEK": 10.415863,
				"SGD": 1.373842,
				"SHP": 0.826433,
				"SLL": 17654.408894,
				"SOS": 562.571891,
				"SRD": 30.869497,
				"SSP": 130.182206,
				"STD": 22810.305026,
				"STN": 24.091303,
				"SVC": 8.746572,
				"SYP": 2511.024138,
				"SZL": 17.148873,
				"THB": 35.915426,
				"TJS": 9.945784,
				"TMT": 3.497781,
				"TND": 3.241865,
				"TOP": 2.372477,
				"TRY": 18.603029,
				"TTD": 6.785134,
				"TWD": 30.925314,
				"TZS": 2331.102721,
				"UAH": 36.546931,
				"UGX": 3738.397393,
				"USD": 1,
				"UYU": 39.268495,
				"UZS": 11216.844726,
				"VES": 10.216885,
				"VND": 24829.829328,
				"VUV": 122.18603,
				"WST": 2.79285,
				"XAF": 628.048627,
				"XAG": 0.046613,
				"XAU": 0.00157,
				"XCD": 2.70132,
				"XDR": 0.744769,
				"XOF": 628.049174,
				"XPD": 0.001722,
				"XPF": 114.255693,
				"XPT": 0.001316,
				"YER": 250.051345,
				"ZAR": 16.93202,
				"ZMW": 16.624909,
				"ZWL": 321.807326
		}
	}`

	var result configuration.CurrencyData

	err := json.Unmarshal([]byte(s), &result)
	assert.NoError(t, err)

	assert.Equal(t, 321.807326, result.Rates.ZWL)
}
